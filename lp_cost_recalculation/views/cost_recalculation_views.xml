<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="view_material_loss_allocation_form" model="ir.ui.view">
        <field name="name">material.loss.allocation.form</field>
        <field name="model">lp_cost_recalculation.material.loss.allocation</field>
            <field name="arch" type="xml">
                <form string="Material Loss Allocation">
                    <header>
                        <button name="compute_allocation" string="Compute Allocation"
                                class="oe_highlight" type="object"
                                attrs="{'invisible': [('state', '!=', 'draft')]}"/>
                        <button name="validate" string="Validate"
                                class="oe_highlight" type="object"
                                attrs="{'invisible': [('state', '!=', 'allocation_derived')]}"/>
                        <button name="button_draft" string="Reset to Draft" type="object"
                                attrs="{'invisible': [('state', '!=', 'allocation_derived')]}"/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,allocation_derived,posted"/>
                    </header>
                    <sheet>
                        <div name="button_box" class="oe_button_box">
                            <button type="object" name="action_view_related_move_lines" 
                                class="oe_stat_button" icon="fa-usd">
                                <field string="Valuation" name="account_move_count" widget="statinfo"/>
                            </button>
                        </div>

                        <group>
                            <group>
                                <field name="year" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                                <field name="month" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                            </group>
                            <group>
                                <label for="date_from" class="text-muted"/>
                                <field name="date_from" readonly="1" nolabel="1" class="text-muted"/>
                                <label for="date_to" class="text-muted"/>
                                <field name="date_to" readonly="1" nolabel="1" class="text-muted"/>
                            </group>
                        </group>
                        <div class="oe_title">
                            <h1><field name="name" placeholder="Name" nolabel="1" attrs="{'readonly': [('state', '=', 'posted')]}"/></h1>
                        </div>
                        <group>
                            <group>
                                <field name="inventory_adjustment_id" attrs="{'readonly': [('state', '!=', 'draft')]}" options="{'no_create_edit': True}"/>
                            </group>
                            <group>
                                <field name="journal_id" attrs="{'readonly': [('state', '!=', 'draft')]}" options="{'no_create_edit': True}"/>
                                <field name="company_id" groups="base.group_multi_company"/>
                                <field name="currency_id" attrs="{'readonly': [('state', '!=', 'draft')]}" groups="base.group_multi_currency" options="{'no_create_edit': True}"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="List Material and Cost">
                                <field name="delta_line_ids" readonly="1">
                                    <tree edit="0" create="0" delete="0">
                                        <field name="currency_id" invisible="1"/>
                                        <field name="material_id" readonly="1"/>
                                        <field name="delta_quantity" readonly="1"/>
                                        <field name="delta_cost" widget="monetary" readonly="1"/>
                                    </tree>
                                </field>
                                <p attrs="{'invisible': [('delta_line_ids', '!=', [])]}">
                                    Use the <strong>Compute Allocation</strong> button to create lines here.
                                </p>
                            </page>
                            <page string="Allocation">
                                <button name="export_allocation_lines" string="Generate XLSX Export"
                                        class="oe_highlight" type="object"
                                        attrs="{'invisible': ['|', ('allocation_line_ids', '=', []), ('allocation_lines_xlsx', '!=', False)]}"/>
                                <button name="export_allocation_lines" string="Re-Generate XLSX Export"
                                        class="oe_highlight" type="object"
                                        attrs="{'invisible': ['|', ('allocation_line_ids', '=', []), ('allocation_lines_xlsx', '=', False)]}"/>
                                <field name="allocation_lines_xlsx_filename" invisible="1"/>
                                <field name="allocation_lines_xlsx"
                                    filename="allocation_lines_xlsx_filename"
                                    class="ml-4"
                                    attrs="{'invisible': [('allocation_lines_xlsx', '=', False)]}"/>
                                <field name="allocation_line_ids" readonly="1">
                                    <tree edit="0" create="0" delete="0">
                                        <field name="currency_id" invisible="1"/>
                                        <field name="material_id" readonly="1"/>
                                        <field name="lp_product_id" readonly="1"/>
                                        <field name="wip_pack" readonly="1"/>
                                        <field name="mo_id" readonly="1"/>
                                        <field name="parent_mo_id" readonly="1"/>
                                        <field name="pa_product_id" readonly="1"/>
                                        <field name="lp_qty" readonly="1"/>
                                        <field name="pa_qty" readonly="1"/>
                                        <field name="product_on_hand_qty" readonly="1"/>
                                        <field name="product_on_hand_value" readonly="1"/>
                                        <field name="ceq_factor" readonly="1"/>
                                        <field name="ceq_converted_qty" readonly="1"/>
                                        <field name="allocation_ratio" readonly="1"/>
                                        <field name="material_loss_allocation" readonly="1"/>
                                        <field name="shipped_qty_lp" readonly="1"/>
                                        <field name="shipped_qty_pa" readonly="1"/>
                                        <field name="cogs_allocated_lp" widget="monetary" readonly="1"/>
                                        <field name="cogs_allocated_pa" widget="monetary" readonly="1"/>
                                        <field name="unit_cost_to_adjust_by_lp" widget="monetary" readonly="1"/>
                                        <field name="unit_cost_to_adjust_by_pa" widget="monetary" readonly="1"/>
                                        <field name="rounding_difference" readonly="1"/>
                                    </tree>
                                </field>
                                <p attrs="{'invisible': [('allocation_line_ids', '!=', [])]}">
                                    Use the <strong>Compute Allocation</strong> button to create lines here.
                                </p>
                                <group attrs="{'invisible': [('allocation_line_ids', '=', [])]}">
                                    <field name="allocation_rounding_difference" readonly="1"/>
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
    </record>

    <record id="view_material_loss_allocation_tree" model="ir.ui.view">
        <field name="name">material.loss.allocation.tree</field>
        <field name="model">lp_cost_recalculation.material.loss.allocation</field>
        <field name="arch" type="xml">
            <tree string="Material Loss Allocation">
                <field name="name"/>
                <field name="create_date" string="Date"/>
                <field name="state"/>
                <field name="company_id" groups="base.group_multi_company"/>
            </tree>
        </field>
    </record>

    <record id="view_labor_cost_allocation_form" model="ir.ui.view">
        <field name="name">labor.cost.allocation.form</field>
        <field name="model">lp_cost_recalculation.labor.cost.allocation</field>
            <field name="arch" type="xml">
                <form string="Labor Cost Allocation">
                    <header>
                        <button name="summarize_calculated_labor_cost"
                                string="Summarize Calculated Labor Cost"
                                class="oe_highlight" type="object"
                                attrs="{'invisible': ['|', ('delta_line_ids', '!=', []), ('state', '!=', 'draft')]}"/>
                        <button name="compute_allocation" string="Compute Allocation"
                                class="oe_highlight" type="object"
                                attrs="{'invisible': ['|', ('delta_line_ids', '=', []), ('state', '!=', 'draft')]}"/>
                        <button name="summarize_calculated_labor_cost"
                                string="Re-Summarize Calculated Labor Cost" type="object"
                                attrs="{'invisible': ['|', ('delta_line_ids', '=', []), ('state', '!=', 'draft')]}"/>
                        <button name="validate" string="Validate"
                                class="oe_highlight" type="object"
                                attrs="{'invisible': [('state', '!=', 'allocation_derived')]}"/>
                        <button name="button_draft" string="Reset to Draft" type="object"
                                attrs="{'invisible': [('state', '!=', 'allocation_derived')]}"/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,allocation_derived,posted"/>
                    </header>
                    <sheet>
                        <div name="button_box" class="oe_button_box">
                            <button type="object" name="action_view_related_move_lines" 
                                    class="oe_stat_button" icon="fa-usd">
                                <field string="Valuation" name="account_move_count" widget="statinfo"/>
                            </button>
                        </div>

                        <group>
                            <group>
                                <field name="year" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                                <field name="month" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                            </group>
                            <group>
                                <label for="date_from" class="text-muted"/>
                                <field name="date_from" readonly="1" nolabel="1" class="text-muted"/>
                                <label for="date_to" class="text-muted"/>
                                <field name="date_to" readonly="1" nolabel="1" class="text-muted"/>
                            </group>
                        </group>
                        <div class="oe_title">
                            <h1><field name="name" placeholder="Name" nolabel="1" attrs="{'readonly': [('state', '=', 'posted')]}"/></h1>
                        </div>
                        <group>
                            <group>
                                <field name="journal_id" attrs="{'readonly': [('state', '!=', 'draft')]}" options="{'no_create_edit': True}"/>
                                <field name="company_id" groups="base.group_multi_company"/>
                                <field name="currency_id" attrs="{'readonly': [('state', '!=', 'draft')]}" groups="base.group_multi_currency" options="{'no_create_edit': True}"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="List Labor Cost Gap">
                                <group invisible="1"/> <!-- Invisible group still affects margin-top of next group - this hack protects the UI from jumping -->
                                <group attrs="{'invisible': [('error_to_correct', '=', 0.0)]}" class="text-danger">
                                    <field name="error_to_correct" widget="monetary"/>
                                </group>
                                <group attrs="{'invisible': [('error_to_correct', '!=', 0.0)]}">
                                    <field name="error_to_correct" widget="monetary"/>
                                </group>
                                <field name="delta_line_ids" attrs="{'readonly': [('state', '!=', 'draft')]}">
                                    <tree editable="bottom" create="0" delete="0">
                                        <field name="currency_id" invisible="1"/>
                                        <field name="workcenter_id" readonly="1"/>
                                        <field name="calculated_labor_cost" widget="monetary" readonly="1"/>
                                        <field name="wrong_input_correction" widget="monetary"/>
                                        <field name="corrected_calculated_cost" widget="monetary"/>
                                        <field name="actual_labor_cost" widget="monetary"/>
                                        <field name="delta_cost" widget="monetary" readonly="1"/>
                                    </tree>
                                </field>
                                <p attrs="{'invisible': [('delta_line_ids', '!=', [])]}">
                                    Use the <strong>Summarize Calculated Labor Cost</strong> button to create lines here.
                                </p>
                                <group attrs="{'invisible': [('delta_line_ids', '=', [])]}" class="row">
                                    <group class="o_group_col_4 col-lg-4">
                                        <field name="total_calculated_labor_cost" widget="monetary"/>
                                        <field name="total_calculated_labor_cost_by_accounting" widget="monetary"/>
                                        <field name="total_calculated_labor_cost_corrected" widget="monetary"/>
                                        <field name="error_to_correct" widget="monetary" attrs="{'invisible': [('error_to_correct', '=', 0.0)]}" class="text-danger"/>
                                        <field name="error_to_correct" widget="monetary" attrs="{'invisible': [('error_to_correct', '!=', 0.0)]}"/>
                                    </group>
                                    <div class="o_group o_group_col_8 col-lg-7 p-0">
                                        <p attrs="{'invisible': ['|', ('state', '!=', 'draft'), ('error_to_correct', '=', 0.0)]}" class="text-danger">
                                            Fill each line's <strong>Wrong Input Correction</strong> to make the resulting <strong>Error To Correct</strong> zero. If you want to start over, use the <strong>Re-Summarize Calculated Labor Cost</strong> button to delete all the lines and create them again.
                                        </p>
                                        <p attrs="{'invisible': ['|', ('state', '!=', 'draft'), ('error_to_correct', '!=', 0.0)]}">
                                            Fill each line's <strong>Actual Labor Cost</strong> and click the <strong>Compute Allocation</strong> button. If you want to start over, use the <strong>Re-Summarize Calculated Labor Cost</strong> button to delete all the lines and create them again.
                                        </p>
                                    </div>
                                </group>
                            </page>
                            <page string="Allocation">
                                <button name="export_allocation_lines" string="Generate XLSX Export"
                                        class="oe_highlight" type="object"
                                        attrs="{'invisible': ['|', ('allocation_line_ids', '=', []), ('allocation_lines_xlsx', '!=', False)]}"/>
                                <button name="export_allocation_lines" string="Re-Generate XLSX Export"
                                        class="oe_highlight" type="object"
                                        attrs="{'invisible': ['|', ('allocation_line_ids', '=', []), ('allocation_lines_xlsx', '=', False)]}"/>
                                <field name="allocation_lines_xlsx_filename" invisible="1"/>
                                <field name="allocation_lines_xlsx"
                                    filename="allocation_lines_xlsx_filename"
                                    class="ml-4"
                                    attrs="{'invisible': [('allocation_lines_xlsx', '=', False)]}"/>
                                <field name="allocation_line_ids" readonly="1">
                                    <tree edit="0" create="0" delete="0">
                                        <field name="currency_id" invisible="1"/>
                                        <field name="workcenter_id" readonly="1"/>
                                        <field name="lp_product_id" readonly="1"/>
                                        <field name="wip_pack" readonly="1"/>
                                        <field name="mo_id" readonly="1"/>
                                        <field name="parent_mo_id" readonly="1"/>
                                        <field name="pa_product_id" readonly="1"/>
                                        <field name="lp_qty" readonly="1"/>
                                        <field name="pa_qty" readonly="1"/>
                                        <field name="product_on_hand_qty" readonly="1"/>
                                        <field name="product_on_hand_value" readonly="1"/>
                                        <field name="calculated_cost" widget="monetary" readonly="1"/>
                                        <field name="allocation_ratio" readonly="1"/>
                                        <field name="gap_allocated_value" readonly="1"/>
                                        <field name="shipped_qty_lp" readonly="1"/>
                                        <field name="shipped_qty_pa" readonly="1"/>
                                        <field name="cogs_allocated_lp" widget="monetary" readonly="1"/>
                                        <field name="cogs_allocated_pa" widget="monetary" readonly="1"/>
                                        <field name="unit_cost_to_adjust_by_lp" widget="monetary" readonly="1"/>
                                        <field name="unit_cost_to_adjust_by_pa" widget="monetary" readonly="1"/>
                                        <field name="rounding_difference" readonly="1"/>
                                    </tree>
                                </field>
                                <p attrs="{'invisible': [('allocation_line_ids', '!=', [])]}">
                                    After summarizing calculated labor cost and inputting the actual labor cost, use the <strong>Compute Allocation</strong> button to create lines here.
                                </p>
                                <group attrs="{'invisible': [('allocation_line_ids', '=', [])]}">
                                    <field name="allocation_rounding_difference" readonly="1"/>
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
    </record>

    <record id="view_labor_cost_allocation_tree" model="ir.ui.view">
        <field name="name">labor.cost.allocation.tree</field>
        <field name="model">lp_cost_recalculation.labor.cost.allocation</field>
        <field name="arch" type="xml">
            <tree string="Labor Cost Allocation">
                <field name="name"/>
                <field name="create_date" string="Date"/>
                <field name="state"/>
                <field name="company_id" groups="base.group_multi_company"/>
            </tree>
        </field>
    </record>

    <record id="view_click_charge_allocation_form" model="ir.ui.view">
        <field name="name">click.charge.allocation.form</field>
        <field name="model">lp_cost_recalculation.click.charge.allocation</field>
            <field name="arch" type="xml">
                <form string="Click Charge Allocation">
                    <header>
                        <button name="generate_line"
                                string="Sum Total Printed Sides"
                                class="oe_highlight" type="object"
                                attrs="{'invisible': ['|', ('delta_line_ids', '!=', []), ('state', '!=', 'draft')]}"/>
                        <button name="compute_allocation" string="Compute Allocation"
                                class="oe_highlight" type="object"
                                attrs="{'invisible': ['|', ('delta_line_ids', '=', []), ('state', '!=', 'draft')]}"/>
                        <button name="generate_line"
                                string="Re-Sum Total Printed Sides"
                                type="object"
                                attrs="{'invisible': ['|', ('delta_line_ids', '=', []), ('state', '!=', 'draft')]}"/>
                        <button name="validate" string="Validate"
                                class="oe_highlight" type="object"
                                attrs="{'invisible': [('state', '!=', 'allocation_derived')]}"/>
                        <button name="button_draft" string="Reset to Draft" type="object"
                                attrs="{'invisible': [('state', '!=', 'allocation_derived')]}"/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,allocation_derived,posted"/>
                    </header>
                    <sheet>
                        <div name="button_box" class="oe_button_box">
                            <button type="object" name="action_view_related_move_lines" 
                                    class="oe_stat_button" icon="fa-usd">
                                <field string="Valuation" name="account_move_count" widget="statinfo"/>
                            </button>
                        </div>

                        <group>
                            <group>
                                <field name="year" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                                <field name="month" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                            </group>
                            <group>
                                <label for="date_from" class="text-muted"/>
                                <field name="date_from" readonly="1" nolabel="1" class="text-muted"/>
                                <label for="date_to" class="text-muted"/>
                                <field name="date_to" readonly="1" nolabel="1" class="text-muted"/>
                            </group>
                        </group>
                        <div class="oe_title">
                            <h1><field name="name" placeholder="Name" nolabel="1" attrs="{'readonly': [('state', '=', 'posted')]}"/></h1>
                        </div>
                        <group>
                            <group>
                                <field name="journal_id" attrs="{'readonly': [('state', '!=', 'draft')]}" options="{'no_create_edit': True}"/>
                                <field name="company_id" groups="base.group_multi_company"/>
                                <field name="currency_id" attrs="{'readonly': [('state', '!=', 'draft')]}" groups="base.group_multi_currency" options="{'no_create_edit': True}"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="List Click Charge">
                                <field name="delta_line_ids" attrs="{'readonly': [('state', '!=', 'draft')]}">
                                    <tree editable="bottom" create="0" delete="0">
                                        <field name="currency_id" invisible="1"/>
                                        <field name="calculated_sides" readonly="1"/>
                                        <field name="calculated_cost" readonly="1" widget="monetary"/>
                                        <field name="actual_cost" widget="monetary"/>
                                        <field name="delta_cost" readonly="1" widget="monetary"/>
                                    </tree>
                                </field>
                                <p attrs="{'invisible': [('delta_line_ids', '!=', [])]}">
                                    Use the <strong>Sum Total Printed Sides</strong> button to create lines here.
                                </p>
                                <p attrs="{'invisible': ['|', ('delta_line_ids', '=', []), ('state', '!=', 'draft')]}">
                                    Fill the <strong>Actual Sides</strong> and <strong>Unit Cost Per Click</strong> fileds and click the <strong>Compute Allocation</strong> button. If you want to start over, click the <strong>Re-Sum Total Printed Sides</strong> button.
                                </p>
                            </page>
                            <page string="Allocation">
                                <button name="export_allocation_lines" string="Generate XLSX Export"
                                        class="oe_highlight" type="object"
                                        attrs="{'invisible': ['|', ('allocation_line_ids', '=', []), ('allocation_lines_xlsx', '!=', False)]}"/>
                                <button name="export_allocation_lines" string="Re-Generate XLSX Export"
                                        class="oe_highlight" type="object"
                                        attrs="{'invisible': ['|', ('allocation_line_ids', '=', []), ('allocation_lines_xlsx', '=', False)]}"/>
                                <field name="allocation_lines_xlsx_filename" invisible="1"/>
                                <field name="allocation_lines_xlsx"
                                    filename="allocation_lines_xlsx_filename"
                                    class="ml-4"
                                    attrs="{'invisible': [('allocation_lines_xlsx', '=', False)]}"/>
                                <field name="allocation_line_ids" readonly="1">
                                    <tree edit="0" create="0" delete="0">
                                        <field name="currency_id" invisible="1"/>
                                        <field name="lp_product_id" readonly="1"/>
                                        <field name="wip_pack" readonly="1"/>
                                        <field name="mo_id" readonly="1"/>
                                        <field name="parent_mo_id" readonly="1"/>
                                        <field name="pa_product_id" readonly="1"/>
                                        <field name="lp_qty" readonly="1"/>
                                        <field name="pa_qty" readonly="1"/>
                                        <field name="product_on_hand_qty" readonly="1"/>
                                        <field name="product_on_hand_value" readonly="1"/>
                                        <field name="calculated_cost" readonly="1"/>
                                        <field name="allocation_ratio" readonly="1"/>
                                        <field name="allocated_value" readonly="1"/>
                                        <field name="shipped_qty_lp" readonly="1"/>
                                        <field name="shipped_qty_pa" readonly="1"/>
                                        <field name="cogs_allocated_lp" widget="monetary" readonly="1"/>
                                        <field name="cogs_allocated_pa" widget="monetary" readonly="1"/>
                                        <field name="unit_cost_to_adjust_by_lp" widget="monetary" readonly="1"/>
                                        <field name="unit_cost_to_adjust_by_pa" widget="monetary" readonly="1"/>
                                        <field name="rounding_difference" readonly="1"/>
                                    </tree>
                                </field>
                                <p attrs="{'invisible': [('allocation_line_ids', '!=', [])]}">
                                    After generating click charge lines and inputting the actual values, use the <strong>Compute Allocation</strong> button to create lines here.
                                </p>
                                <group attrs="{'invisible': [('allocation_line_ids', '=', [])]}">
                                    <field name="allocation_rounding_difference" readonly="1"/>
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
    </record>

    <record id="view_click_charge_allocation_tree" model="ir.ui.view">
        <field name="name">click.charge.allocation.tree</field>
        <field name="model">lp_cost_recalculation.click.charge.allocation</field>
        <field name="arch" type="xml">
            <tree string="Click Charge Allocation">
                <field name="name"/>
                <field name="create_date" string="Date"/>
                <field name="state"/>
                <field name="company_id" groups="base.group_multi_company"/>
            </tree>
        </field>
    </record>

    <record id="view_overhead_cost_allocation_form" model="ir.ui.view">
        <field name="name">overhead.cost.allocation.form</field>
        <field name="model">lp_cost_recalculation.overhead.cost.allocation</field>
            <field name="arch" type="xml">
                <form string="Overhead Cost Allocation">
                    <header>
                        <button name="compute_allocation" string="Compute Allocation"
                                class="oe_highlight" type="object"
                                attrs="{'invisible': ['|', ('delta_line_ids', '=', []), ('state', '!=', 'draft')]}"/>
                        <button name="validate" string="Validate"
                                class="oe_highlight" type="object"
                                attrs="{'invisible': [('state', '!=', 'allocation_derived')]}"/>
                        <button name="button_draft" string="Reset to Draft" type="object"
                                attrs="{'invisible': [('state', '!=', 'allocation_derived')]}"/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,allocation_derived,posted"/>
                    </header>
                    <sheet>
                        <div name="button_box" class="oe_button_box">
                            <button type="object" name="action_view_related_move_lines" 
                                    class="oe_stat_button" icon="fa-usd">
                                <field string="Valuation" name="account_move_count" widget="statinfo"/>
                            </button>
                        </div>

                        <group>
                            <group>
                                <field name="year" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                                <field name="month" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                            </group>
                            <group>
                                <label for="date_from" class="text-muted"/>
                                <field name="date_from" readonly="1" nolabel="1" class="text-muted"/>
                                <label for="date_to" class="text-muted"/>
                                <field name="date_to" readonly="1" nolabel="1" class="text-muted"/>
                            </group>
                        </group>
                        <div class="oe_title">
                            <h1><field name="name" placeholder="Name" nolabel="1" attrs="{'readonly': [('state', '=', 'posted')]}"/></h1>
                        </div>
                        <group>
                            <group>
                                <field name="journal_id" attrs="{'readonly': [('state', '!=', 'draft')]}" options="{'no_create_edit': True}"/>
                                <field name="company_id" groups="base.group_multi_company"/>
                                <field name="currency_id" attrs="{'readonly': [('state', '!=', 'draft')]}" groups="base.group_multi_currency" options="{'no_create_edit': True}"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Input Overhead Cost">
                                <field name="delta_line_ids" attrs="{'readonly': [('state', '!=', 'draft')]}">
                                    <tree editable="bottom">
                                        <field name="currency_id" invisible="1"/>
                                        <field name="overhead_cost_account_id" required="1"/>
                                        <field name="actual_cost" widget="monetary" required="1"/>
                                    </tree>
                                </field>
                                <p attrs="{'invisible': [('delta_line_ids', '!=', [])]}">
                                    Create lines here.
                                </p>
                                <p attrs="{'invisible': ['|', ('delta_line_ids', '=', []), ('state', '!=', 'draft')]}">
                                    Fill each line's <strong>Overhead Cost Account</strong> and <strong>Actual Cost</strong> and click the <strong>Compute Allocation</strong> button.
                                </p>
                            </page>
                            <page string="Allocation">
                                <button name="export_allocation_lines" string="Generate XLSX Export"
                                        class="oe_highlight" type="object"
                                        attrs="{'invisible': ['|', ('allocation_line_ids', '=', []), ('allocation_lines_xlsx', '!=', False)]}"/>
                                <button name="export_allocation_lines" string="Re-Generate XLSX Export"
                                        class="oe_highlight" type="object"
                                        attrs="{'invisible': ['|', ('allocation_line_ids', '=', []), ('allocation_lines_xlsx', '=', False)]}"/>
                                <field name="allocation_lines_xlsx_filename" invisible="1"/>
                                <field name="allocation_lines_xlsx"
                                    filename="allocation_lines_xlsx_filename"
                                    class="ml-4"
                                    attrs="{'invisible': [('allocation_lines_xlsx', '=', False)]}"/>
                                <field name="allocation_line_ids" readonly="1">
                                    <tree edit="0" create="0" delete="0">
                                        <field name="lp_product_id" readonly="1"/>
                                        <field name="wip_pack" readonly="1"/>
                                        <field name="mo_id" readonly="1"/>
                                        <field name="parent_mo_id" readonly="1"/>
                                        <field name="pa_product_id" readonly="1"/>
                                        <field name="lp_qty" readonly="1"/>
                                        <field name="pa_qty" readonly="1"/>
                                        <field name="product_on_hand_qty" readonly="1"/>
                                        <field name="product_on_hand_value" readonly="1"/>
                                        <field name="ceq_factor" readonly="1"/>
                                        <field name="ceq_converted_qty" readonly="1"/>
                                        <field name="allocation_ratio" readonly="1"/>
                                        <field name="overhead_cost_allocation" readonly="1"/>
                                        <field name="shipped_qty_lp" readonly="1"/>
                                        <field name="shipped_qty_pa" readonly="1"/>
                                        <field name="cogs_allocated_lp" widget="monetary" readonly="1"/>
                                        <field name="cogs_allocated_pa" widget="monetary" readonly="1"/>
                                        <field name="unit_cost_to_adjust_by_lp" widget="monetary" readonly="1"/>
                                        <field name="unit_cost_to_adjust_by_pa" widget="monetary" readonly="1"/>
                                        <field name="rounding_difference" readonly="1"/>
                                    </tree>
                                </field>
                                <p attrs="{'invisible': [('allocation_line_ids', '!=', [])]}">
                                    After filling in the overhead cost lines, use the <strong>Compute Allocation</strong> button to create lines here.
                                </p>
                                <group attrs="{'invisible': [('allocation_line_ids', '=', [])]}">
                                    <field name="allocation_rounding_difference" readonly="1"/>
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
    </record>

    <record id="view_overhead_cost_allocation_tree" model="ir.ui.view">
        <field name="name">overhead.cost.allocation.tree</field>
        <field name="model">lp_cost_recalculation.overhead.cost.allocation</field>
        <field name="arch" type="xml">
            <tree string="Overhead Cost Allocation">
                <field name="name"/>
                <field name="create_date" string="Date"/>
                <field name="state"/>
                <field name="company_id" groups="base.group_multi_company"/>
            </tree>
        </field>
    </record>

    <menuitem id="product_cost_recalculation_menu" name="Product Cost Recalculation" parent="account_accountant.menu_accounting" sequence="4"/>

    <record id="action_view_list_material_loss_allocation" model="ir.actions.act_window">
        <field name="name">Material Loss Allocation</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">lp_cost_recalculation.material.loss.allocation</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="view_material_loss_allocation_tree"/>
    </record>

    <menuitem id="material_loss_allocation_menu" name="Material Loss Allocation" parent="product_cost_recalculation_menu"
            action="action_view_list_material_loss_allocation" sequence="1"/>

    <record id="action_view_list_labor_cost_allocation" model="ir.actions.act_window">
        <field name="name">Labor Cost Allocation</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">lp_cost_recalculation.labor.cost.allocation</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="view_labor_cost_allocation_tree"/>
    </record>

    <menuitem id="labor_cost_allocation_menu" name="Labor Cost Allocation" parent="product_cost_recalculation_menu"
            action="action_view_list_labor_cost_allocation" sequence="1"/>

    <record id="action_view_list_click_charge_allocation" model="ir.actions.act_window">
        <field name="name">Click Charge Allocation</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">lp_cost_recalculation.click.charge.allocation</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="view_click_charge_allocation_tree"/>
    </record>

    <menuitem id="click_charge_allocation_menu" name="Click Charge Allocation" parent="product_cost_recalculation_menu"
            action="action_view_list_click_charge_allocation" sequence="1"/>

    <record id="action_view_list_overhead_cost_allocation" model="ir.actions.act_window">
        <field name="name">Overhead Cost Allocation</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">lp_cost_recalculation.overhead.cost.allocation</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="view_overhead_cost_allocation_tree"/>
    </record>

    <menuitem id="overhead_cost_allocation_menu" name="Overhead Cost Allocation" parent="product_cost_recalculation_menu"
            action="action_view_list_overhead_cost_allocation" sequence="1"/>

</odoo>
